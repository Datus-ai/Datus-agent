Please analyze the following SQL query and its comment, then extract the required metadata in JSON format.

**Comment:** {{ comment }}

**SQL Query:**
```sql
{{ sql }}
```

Please provide the analysis in the following JSON format:
{
    "summary": "Brief 1-2 sentence description of what this SQL query does",
    "domain": "Business domain (e.g., gaming, finance, ecommerce, analytics, etc.)",
    "layer1": "Primary category (e.g., user_analysis, performance_metrics, financial_report, etc.)",
    "layer2": "Secondary category (e.g., retention, scoring, revenue, efficiency, etc.)",
    "tags": "Comma-separated relevant keywords (e.g., user,score,island,survival,rating)"
}

Guidelines:
- Make the summary concise but descriptive
- Choose domain based on the business context evident in the SQL
- layer1 should be a broad functional category
- layer2 should be more specific within that category
- tags should be relevant business and technical keywords
- IMPORTANT: Keep the same language as the comment - if the comment is in Chinese, generate summary/domain/layer1/layer2/tags in Chinese; if in English, use English. Do NOT translate between languages
- Keep all values as strings